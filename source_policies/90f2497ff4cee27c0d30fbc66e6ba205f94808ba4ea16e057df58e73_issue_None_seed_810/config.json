{"setup": {"seed": 810, "load_seed": 42, "load": 0, "load_dir": 0, "load_dir_2": 0, "load_dir_3": 0, "pseudo_thres": 10, "pseudo_interval": 150, "use_evo": 0, "setup": "metaworld", "relabel_num_tasks": 50, "relabel_range": 1, "load_log_std_bounds": [-20, 2], "base_path": "/data2/zj/NewMTRL", "save_dir": "${setup.base_path}/logs/${setup.id}", "device": "cuda:0", "id": "90f2497ff4cee27c0d30fbc66e6ba205f94808ba4ea16e057df58e73_issue_None_seed_810", "description": "Sample Task", "tags": null, "git": {"commit_id": "63ca3f7492e17c1cd5a9ee503b282f255798d4a5", "has_uncommitted_changes": null, "issue_id": null}, "date": "2022-04-05 10:34:33", "slurm_id": "-1", "debug": {"should_enable": false}}, "experiment": {"name": "metaworld", "builder": {"_target_": "mtrl.experiment.${experiment.name}.Experiment"}, "init_steps": 5000, "num_train_steps": 2000000, "eval_freq": 10000, "num_eval_episodes": 1, "should_resume": true, "save": {"model": {"retain_last_n": 1}, "buffer": {"should_save": true, "size_per_chunk": 10000, "num_samples_to_save": -1}}, "save_dir": "${setup.save_dir}", "save_video": false, "envs_to_exclude_during_training": null}, "agent": {"name": "state_sac", "encoder_feature_dim": 39, "num_layers": 0, "num_filters": 0, "builder": {"_target_": "mtrl.agent.sac.Agent", "actor_cfg": "${agent.actor}", "critic_cfg": "${agent.critic}", "multitask_cfg": "${agent.multitask}", "alpha_optimizer_cfg": "${agent.optimizers.alpha}", "actor_optimizer_cfg": "${agent.optimizers.actor}", "critic_optimizer_cfg": "${agent.optimizers.critic}", "discount": 0.99, "init_temperature": 1.0, "actor_update_freq": 1, "critic_tau": 0.005, "critic_target_update_freq": 1, "encoder_tau": 0.05}, "actor": {"_target_": "mtrl.agent.components.actor.Actor", "num_layers": 3, "hidden_dim": 400, "log_std_bounds": [-20, 2], "encoder_cfg": "${agent.encoder}", "multitask_cfg": "${agent.multitask}"}, "critic": {"_target_": "mtrl.agent.components.critic.Critic", "hidden_dim": "${agent.actor.hidden_dim}", "num_layers": "${agent.actor.num_layers}", "encoder_cfg": "${agent.encoder}", "multitask_cfg": "${agent.multitask}"}, "encoder": {"type_to_select": "identity", "identity": {"type": "identity", "feature_dim": "${agent.encoder_feature_dim}"}, "feedforward": {"type": "feedforward", "hidden_dim": 50, "num_layers": 2, "feature_dim": "${agent.encoder_feature_dim}", "should_tie_encoders": true}, "film": {"type": "film", "hidden_dim": 50, "num_layers": 2, "feature_dim": "${agent.encoder_feature_dim}", "should_tie_encoders": true}, "moe": {"type": "moe", "encoder_cfg": {"type": "feedforward", "hidden_dim": 50, "num_layers": 2, "feature_dim": "${agent.encoder_feature_dim}", "should_tie_encoders": true}, "num_experts": 9, "task_id_to_encoder_id_cfg": {"mode": "cluster", "num_envs": "${env.num_envs}", "gate": {"embedding_dim": 50, "hidden_dim": 50, "num_layers": 2, "temperature": 1.0, "should_use_soft_attention": false, "topk": 2, "task_encoder_cfg": {"should_use_task_encoding": true, "should_detach_task_encoding": true}}, "attention": {"embedding_dim": 50, "hidden_dim": 50, "num_layers": 2, "temperature": 1.0, "should_use_soft_attention": true, "task_encoder_cfg": {"should_use_task_encoding": true, "should_detach_task-encoding": true}}, "cluster": {"env_name": "${env.name}", "task_description": "${env.description}", "ordered_task_list": "${env.ordered_task_list}", "mapping_cfg": "${agent.task_to_encoder_cluster}", "num_eval_episodes": "${experiment.num_eval_episodes}", "batch_size": "${replay_buffer.batch_size}"}, "identity": {"num_eval_episodes": "${experiment.num_eval_episodes}", "batch_size": "${replay_buffer.batch_size}"}, "ensemble": {"num_eval_episodes": "${experiment.num_eval_episodes}", "batch_size": "${replay_buffer.batch_size}"}}}, "factorized_moe": {"type": "fmoe", "encoder_cfg": "${agent.encoder.feedforward}", "num_factors": 2, "num_experts_per_factor": [5, 5]}, "pixel": {"type": "pixel", "feature_dim": "${agent.encoder_feature_dim}", "num_filters": "${agent.num_filters}", "num_layers": "${agent.num_layers}"}}, "transition_model": {"_target_": "mtrl.agent.components.transition_model.make_transition_model", "transition_cfg": {"type": "", "feature_dim": "${agent.encoder_feature_dim}", "layer_width": 512}, "multitask_cfg": "${agent.multitask}"}, "mask": {"num_tasks": "${env.num_envs}", "num_eval_episodes": "${experiment.num_eval_episodes}", "batch_size": "${replay_buffer.batch_size}"}, "multitask": {"num_envs": 50, "should_use_disentangled_alpha": true, "should_use_task_encoder": true, "should_use_multi_head_policy": false, "should_use_disjoint_policy": false, "task_encoder_cfg": {"model_cfg": {"_target_": "mtrl.agent.components.task_encoder.TaskEncoder", "pretrained_embedding_cfg": {"should_use": false, "path_to_load_from": "/private/home/sodhani/projects/mtrl/metadata/task_embedding/roberta_small/${env.name}.json", "ordered_task_list": "${env.ordered_task_list}"}, "num_embeddings": "${agent.multitask.num_envs}", "embedding_dim": 50, "hidden_dim": 50, "num_layers": 2, "output_dim": 50}, "optimizer_cfg": "${agent.optimizers.actor}", "losses_to_train": ["critic", "transition_reward", "decoder", "task_encoder"]}, "multi_head_policy_cfg": {"mask_cfg": "${agent.mask}"}, "actor_cfg": {"should_condition_model_on_task_info": false, "should_condition_encoder_on_task_info": true, "should_concatenate_task_info_with_encoder": true, "moe_cfg": {"mode": "soft_modularization", "num_experts": 4, "should_use": false}}, "critic_cfg": "${agent.multitask.actor_cfg}"}, "gradnorm": {"alpha": 1.0}, "task_to_encoder_cluster": {"mt10": {"cluster": {"action_close": ["close"], "action_default": ["insert", "pick and place", "press", "reach"], "action_open": ["open"], "action_push": ["push"], "object_default": ["button", "door", "peg", "revolving joint"], "object_drawer": ["drawer"], "object_goal": ["goal"], "object_puck": ["puck"], "object_window": ["window"]}}, "mt50": {"cluster": {"action_close": ["close"], "action_default": ["insert", "pick and place", "press", "reach"], "action_open": ["open"], "action_push": ["push"], "object_default": ["button", "door", "peg", "revolving joint"], "object_drawer": ["drawer"], "object_goal": ["goal"], "object_puck": ["puck"], "object_window": ["window"]}}}, "optimizers": {"actor": {"_target_": "torch.optim.Adam", "lr": 0.0003, "betas": [0.9, 0.999]}, "alpha": {"_target_": "torch.optim.Adam", "lr": 0.0003, "betas": [0.9, 0.999]}, "critic": {"_target_": "torch.optim.Adam", "lr": 0.0003}, "decoder": {"_target_": "torch.optim.Adam", "lr": 0.0003, "betas": [0.9, 0.999], "weight_decay": 1e-07}, "encoder": {"_target_": "torch.optim.Adam", "lr": 0.0003, "betas": [0.9, 0.999]}}}, "env": {"name": "metaworld-mt50", "num_envs": 50, "task_idx": -1, "fix_goal": 0, "benchmark": {"_target_": "metaworld.MT50"}, "should_perform_reward_normalization": true, "dummy": {"_target_": "metaworld.MT1", "env_name": "pick-place-v1"}, "description": {"reach-v1": "Reach a goal position. Randomize the goal positions.", "push-v1": "Push the puck to a goal. Randomize puck and goal positions.", "pick-place-v1": "Pick and place a puck to a goal. Randomize puck and goal positions.", "door-open-v1": "Open a door with a revolving joint. Randomize door positions.", "drawer-open-v1": "Open a drawer. Randomize drawer positions.", "drawer-close-v1": "Push and close a drawer. Randomize the drawer positions.", "button-press-topdown-v1": "Press a button from the top. Randomize button positions.", "peg-insert-side-v1": "Insert a peg sideways. Randomize peg and goal positions.", "window-open-v1": "Push and open a window. Randomize window positions.", "window-close-v1": "Push and close a window. Randomize window positions.", "door-close-v1": "Close a door with a revolvinig joint. Randomize door positions.", "reach-wall-v1": "Bypass a wall and reach a goal. Randomize goal positions.", "pick-place-wall-v1": "Pick a puck, bypass a wall and place the puck. Randomize puck and goal positions.", "push-wall-v1": "Bypass a wall and push a puck to a goal. Randomize puck and goal positions.", "button-press-v1": "Press a button. Randomize button positions.", "button-press-topdown-wall-v1": "Bypass a wall and press a button from the top. Randomize button positions.", "button-press-wall-v1": "Bypass a wall and press a button. Randomize the button positions.", "peg-unplug-side-v1": "Unplug a peg sideways. Randomize peg positions.", "disassemble-v1": "Pick a nut out of the a peg. Randomize the nut positions.", "hammer-v1": "Hammer a screw on the wall. Randomize the hammer and the screw positions.", "plate-slide-v1": "Get a plate from the cabinet. Randomize plate and cabinet positions", "plate-slide-side-v1": "Get a plate from the cabinet sideways. Randomize plate and cabinet positions", "plate-slide-back-v1": "Slide a plate into a cabinet. Randomize the plate and cabinet positions", "plate-slide-back-side-v1": "Slide a plate into a cabinet sideways. Randomize the plate and cabinet positions", "handle-press-v1": "Press a handle down. Randomize the handle positions", "handle-pull-v1": "Pull a handle up. Randomize the handle positions.", "handle-press-side-v1": "Press a handle down sideways. Randomize the handle positions.", "handle-pull-side-v1": "Pull a handle up sideways. Randomize the handle positions.", "stick-push-v1": "Grasp a stick and push a box using the stick. Randomize stick positions.", "stick-pull-v1": "Grasp a stick and pull a box with the stick. Randomize stick positions.", "basketball-v1": "Dunk the basketball into the basket. Randomize basketball and basket positions.", "soccer-v1": "Kick a soccer into the goal. Randomize the soccer and goal positions.", "faucet-open-v1": "Rotate the faucet counter-clockwise. Randomize faucet positions.", "faucet-close-v1": "Rotate the faucet clockwise. Randomize faucet positions.", "coffee-push-v1": "Push a mug under a coffee machine. Randomize the mug and the machine positions.", "coffee-pull-v1": "Pull a mug from a coffee machine. Randomize the mug and the machine positions.", "coffee-button-v1": "Push a button on the coffee machine. Randomize the position of the coffee machine.", "sweep-v1": "Sweep a puck off the table. Randomize puck positions.", "sweep-into-v1": "Sweep a puck into a hole. Randomize puck positions.", "pick-out-of-hole-v1": "Pick up a puck from a hole. Randomize puck and goal positions.", "assembly-v1": "Pick up a nut and place it onto a peg. Randomize nut and peg positions.", "shelf-place-v1": "Pick and place a puck onto a shelf. Randomize puck and shelf positions.", "push-back-v1": "Pull a puck to a goal. Randomize puck and goal positions.", "lever-pull-v1": "Pull a lever down 90 degrees. Randomize lever positions.", "dial-turn-v1": "Rotate a dial 180 degrees. Randomize dial positions.", "bin-picking-v1": "Grasp the puck from one bin and place it into another bin. Randomize puck positions.", "box-close-v1": "Grasp the cover and close the box with it. Randomize the cover and box positions.", "hand-insert-v1": "Insert the gripper into a hole.", "door-lock-v1": "Lock the door by rotating the lock clockwise. Randomize door positions.", "door-unlock-v1": "Unlock the door by rotating the lock counter-clockwise. Randomize door positions."}, "ordered_task_list": ["assembly-v2", "basketball-v2", "bin-picking-v2", "box-close-v2", "button-press-topdown-v2", "button-press-topdown-wall-v2", "button-press-v2", "button-press-wall-v2", "coffee-button-v2", "coffee-pull-v2", "coffee-push-v2", "dial-turn-v2", "disassemble-v2", "door-close-v2", "door-lock-v2", "door-open-v2", "door-unlock-v2", "hand-insert-v2", "drawer-close-v2", "drawer-open-v2", "faucet-open-v2", "faucet-close-v2", "hammer-v2", "handle-press-side-v2", "handle-press-v2", "handle-pull-side-v2", "handle-pull-v2", "lever-pull-v2", "peg-insert-side-v2", "pick-place-wall-v2", "pick-out-of-hole-v2", "reach-v2", "push-back-v2", "push-v2", "pick-place-v2", "plate-slide-v2", "plate-slide-side-v2", "plate-slide-back-v2", "plate-slide-back-side-v2", "peg-unplug-side-v2", "soccer-v2", "stick-push-v2", "stick-pull-v2", "push-wall-v2", "reach-wall-v2", "shelf-place-v2", "sweep-into-v2", "sweep-v2", "window-open-v2", "window-close-v2"]}, "replay_buffer": {"_target_": "mtrl.replay_buffer.ReplayBuffer", "env_obs_shape": null, "action_shape": null, "capacity": 1000000, "batch_size": 1280}, "logger": {"_target_": "mtrl.logger.Logger", "logger_dir": "${setup.save_dir}", "use_tb": false}, "metrics": {"train": [["episode", "E", "int", "average"], ["step", "S", "int", "average"], ["duration", "D", "time", "average"], ["episode_reward", "R", "float", "average"], ["success", "Su", "float", "average"], ["batch_reward", "BR", "float", "average"], ["actor_loss", "ALOSS", "float", "average"], ["critic_loss", "CLOSS", "float", "average"], ["pig_critic_loss", "PCLOSS", "float", "average"], ["pig_actor_loss", "PALOSS", "float", "average"], ["expert_kl", "EXPERT_KL", "float", "average"], ["weight_0", "W_0", "float", "average"], ["weight_1", "W_1", "float", "average"], ["weight_2", "W_2", "float", "average"], ["weight_3", "W_3", "float", "average"], ["weight_4", "W_4", "float", "average"], ["weight_5", "W_5", "float", "average"], ["weight_6", "W_6", "float", "average"], ["weight_7", "W_7", "float", "average"], ["weight_8", "W_8", "float", "average"], ["weight_9", "W_9", "float", "average"], ["weight_10", "W_10", "float", "average"], ["weight_11", "W_11", "float", "average"], ["weight_12", "W_12", "float", "average"], ["weight_13", "W_13", "float", "average"], ["weight_14", "W_14", "float", "average"], ["weight_15", "W_15", "float", "average"], ["weight_16", "W_11", "float", "average"], ["weight_17", "W_12", "float", "average"], ["weight_18", "W_13", "float", "average"], ["weight_19", "W_14", "float", "average"], ["weight_20", "W_15", "float", "average"], ["significance", "SIG", "float", "average"], ["ae_loss", "RLOSS", "float", "average"], ["ae_transition_loss", null, "float", "average"], ["reward_loss", null, "float", "average"], ["actor_target_entropy", null, "float", "average"], ["actor_entropy", null, "float", "average"], ["alpha_loss", null, "float", "average"], ["alpha_value", null, "float", "average"], ["contrastive_loss", "MLOSS", "float", "average"], ["max_rat", "MR", "float", "average"], ["env_index", "ENV", "str", "constant"], ["episode_reward_env_index_", "R_", "float", "average"], ["success_env_index_", "Su_", "float", "average"], ["env_index_", "ENV_", "str", "constant"], ["batch_reward_agent_index_", null, "float", "average"], ["critic_loss_agent_index_", "AGENT_", "float", "average"], ["actor_distilled_agent_loss_agent_index_", null, "float", "average"], ["actor_loss_agent_index_", null, "float", "average"], ["actor_target_entropy_agent_index_", null, "float", "average"], ["actor_entropy_agent_index_", null, "float", "average"], ["alpha_loss_agent_index_", null, "float", "average"], ["alpha_value_agent_index_", null, "float", "average"], ["ae_loss_agent_index_", null, "float", "average"]], "eval": [["episode", "E", "int", "average"], ["step", "S", "int", "average"], ["episode_reward", "R", "float", "average"], ["env_index", "ENV", "str", "constant"], ["success", "Su", "float", "average"], ["episode_reward_env_index_", "R_", "float", "average"], ["success_env_index_", "Su_", "float", "average"], ["env_index_", "ENV_", "str", "constant"], ["batch_reward_agent_index_", "AGENT_", "float", "average"]]}, "logbook": {"_target_": "ml_logger.logbook.make_config", "write_to_console": false, "logger_dir": "${setup.save_dir}", "create_multiple_log_files": false}}